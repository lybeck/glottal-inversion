\documentclass[12pt,a4]{article}

\usepackage[utf8]{inputenc}
\usepackage[T1]{fontenc}
\usepackage{amsmath,amsfonts}
\usepackage{graphicx}
\usepackage{enumerate}
\DeclareMathOperator*{\argmin}{\arg\!\min}

\newcommand{\R}{{\mathbb R}}
\newcommand{\C}{{\mathbb C}}
\newcommand{\N}{{\mathbb N}}
\newcommand{\ra}{\rightarrow}
\newcommand{\lra}{\longrightarrow}
\newcommand{\lnorm}{\left\|}
\newcommand{\rnorm}{\right\|}
\newcommand{\ind}{{\mathbf{1}}}

\newcommand{\citeneeded}{\ensuremath{\vphantom{1}^{\text{[citation needed]}}\,}}
\newcommand{\eps}{\ensuremath{\varepsilon}}


\title{Glottal inversion with an approximate vocal tract filter}
\author{Lasse Lybeck, Robert Sirviö}


\begin{document}

\maketitle

%---------------------Introduction--------------------
\section{Introduction}\label{sec:intro}

A synthetic human vowel sound consists of a periodic signal to simulate the glottal excitation signal at the glottis and a filter to simulate the vocal tract, which the glottal signal is filtered through.\citeneeded With a given vocal tract filter the direct problem is \emph{given a glottal excitation signal, create the vowel sound}. The inverse problem is \emph{given a (recorded) vowel sound, find the glottal excitation signal}. In this study we will be concentrating on the inverse problem, starting with both a simulated vowel and a real recording.

The inversion from a vowel sound to the glottal signal is an important part of creating synthetic human voices and speech generators. To create a synthetic vowel both the glottal signal and the vocal tract filter are needed. However, the glottal signal cannot be directly measured, but it can be approximated with inversion of a recorded vowel. With this data models for simulating the glottal excitation signal can be created.


%-----------------Materials & Methods-----------------
\section{Materials and Methods}\label{sec:methods}

\subsection{Glottal excitation signal}

In this study the Rosenberg-Klatt model (RK-model) for the glottal excitation signal will be used for the generation of synthetic data and as a reference point for the obtained results. The RK-model is a simple model for the glottal signal, proposed in 1970 by Rosenberg.\cite{rosenberg} As the model creates the signal only from two parameters, the sound frequency $f$ and the so called Klatt-parameter $Q$, it is easy to use and is therefore selected as the model to be used in this study.

The \emph{airflow} for the glottal excitation signal created by the RK-model is defined as
\begin{equation}
\label{eq:RK-model}
g(t) =
  \begin{cases}
   at^2 + bt^3  & \text{jos } 0 \leq t \leq Q T \\
   0            & \text{jos } Q T < t \leq T,
  \end{cases}
\end{equation}
where $t$ is a time variable, $T = 1/f$ is the period of the pitch, $Q \in \left[ 0,1 \right]$ is the Klatt-parameter and $a$ and $b$ are variables defined in terms of $T_0 := QT$ as
\begin{equation*}
a = \frac{27}{4 T_0^2}, \quad b = -\frac{27}{4 T_0^3} .
\end{equation*}
Here the parameter $f$ defines the frequency of the generated signal and the Klatt-parameter $Q$ defines the shape of the pulse.

The glottal excitation signal can be retrieved as the derivative $g'$ of the airflow function. Here $g'$ is the \emph{pressure function}, and simulates the sound generated in the glottis. The pulse generated by the model can be seen in figure \ref{fig:klatt}.

Another, more widely used, model for the glottal excitation signal worth mentioning is the Liljencrants-Fant model (LF-model).\cite{fant} It is regarded as more accurate than the RK-model, but it is also much more complex. It has also been shown, that the LF-model generates only marginally better approximations for the resulting vowel after the vocal tract filtering than the RK-model.\cite{fujisaki} Due to this and the overall complexity of the LF-model we will not be using it in this study.

\begin{figure}[t]
\begin{center}
\includegraphics[scale=1]{img/klattflow.png}
\includegraphics[scale=1]{img/klattpres.png}
\end{center}
\caption{The airflow and pressure generated by the RK-model}
\label{fig:klatt}
\end{figure}


\subsection{Vocal tract filter}

In this study we will assume an approximate vocal tract filter to be known for the recorded vowel we want to invert. The digital filter, defined by a vector $a \in \R^{N_a}$, filters the data $x \in \R^{N_x}$ as defined by the difference equation
\begin{align}
y_1     &= x_1 \\
a_1 y_n &= -\sum_{k=2}^{\min\{n-1, N_a\}} a_{k} y_{n-k}
\end{align}

jatkuu...


\subsection{The matrix model}
\label{sec:matrixModel}

A vowel $v\in\R^n$ can be simulated by applying a digital filter $A\in\R^{n \times n}$ to a sample of a glottal excitation signal $g\in\R^n$ as
\begin{equation}
\label{eq:vow}
v = A g.
\end{equation}
In this study we will assume an approximation of the filter $A$ to be known. Given a measurement $m\in\R^n$ of a vowel corresponding approximately to the filter $A$, equation \eqref{eq:vow} becomes
\begin{equation}
\label{eq:vowModel}
m = A g + \eps,
\end{equation}
where $\eps\in\R^n$ denotes random measurement noise.

jatkuu...

\subsection{The inversion method}\label{subsec:invMethod}

\subsubsection{Tikhonov reguralization}\label{subsubsec:tikh}
The classical Tikhonov regularized solution for $m = Af + \varepsilon$ defined in (ref here) is usually denoted by the vector $T_\alpha(m)\in\R^n$ that minimizes
\begin{equation*}
\lnorm AT_\alpha(m) - m \rnorm^2 + \alpha \lnorm T_\alpha(m) \rnorm^2 \Leftrightarrow
\end{equation*}
\begin{equation*}
T_\alpha(m) = \underset{z\in\R^n}{\argmin}
\left\{ \lnorm Az - m \rnorm^2 + \alpha \lnorm z \rnorm^2 \right\},
\end{equation*}
where $\alpha > 0$ is called a regularization parameter. The resulting $T_\alpha(m)$ can be understood as a compromise between two conditions, namely
\begin{enumerate}[I.]
 \item $T_\alpha(m)$ should give a small residual $AT_\alpha(m) - m$.
 \item $\lnorm T_\alpha(m) \rnorm_2$ should be small.
\end{enumerate}
The $\alpha$ parameter is used in order to tune to balance between the two conditions above.

In generalized Tikhonov regularization some prior knowledge is assumed to be known. In some cases $f$ might be known to be smooth. This information can be incorporated into the regularization by choosing
\begin{equation}
T_\alpha(m) = \underset{z\in\R^n}{\argmin}
\left\{ \lnorm Az - m \rnorm^2 + \alpha \lnorm Lz \rnorm^2 \right\},
\end{equation}  
where $L$ is a discretized differential operator. In our model proposed in \citeneeded we know the glottal impulse to be zero in an interval [mera kama hit när modellen är skriven]


\subsubsection{The conjugate gradient method}\label{subsubsec:conjgrad}

%-----------------------Results-----------------------
\section{Results}\label{sec:results}


%----------------------Discussion---------------------
\section{Discussion}\label{sec:discussion}

\newpage
\begin{thebibliography}{9}

\bibitem{fant}
    Fant, G., Liljencrants, J., Lin, Q., (1985).
    \emph{A four-parameter model of glottal flow}.
    STL-QPSR 26 (4), 1-13
    
\bibitem{fujisaki}
    Fujisaki, H., Ljungqvist, M., 1986.
    Proposal and evaluation of models for the glottal source waveform.
    In: Proc. IEEE International Conference on Acoustics, Speech and Signal Processing (ICASSP). Vol. 11. pp. 1605–1608.
    
\bibitem{samu}
	Mueller, Jennifer L. \& Siltanen Samuli, (2012).
	\emph{Linear and Nonlinear Inverse Problems with Practical Applications}.
	SIAM, 1:st edition

\bibitem{rosenberg}
    Rosenberg, A., (1971).
    \emph{Effect of glottal pulse shape on the quality of natural vowels}.
    Journal of the Acoustical Society of America 49 (2B), 583–590.

\end{thebibliography}

\end{document}



